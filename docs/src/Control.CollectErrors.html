<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">CollectErrors</span><span>
</span><a name="line-3"></a><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- * Monad for collecting errors in expressions</span><span>
</span><a name="line-5"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span>
</span><a name="line-6"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#noValueCE"><span class="hs-identifier hs-var">noValueCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#prependErrorsCE"><span class="hs-identifier hs-var">prependErrorsCE</span></a><span>
</span><a name="line-7"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#filterValuesWithoutErrorCE"><span class="hs-identifier hs-var">filterValuesWithoutErrorCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#getValueIfNoErrorCE"><span class="hs-identifier hs-var">getValueIfNoErrorCE</span></a><span>
</span><a name="line-8"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#ce2ConvertResult"><span class="hs-identifier hs-var">ce2ConvertResult</span></a><span>
</span><a name="line-9"></a><span class="hs-comment">-- * Tools for avoiding @CollectErrors(CollectErrors t)@ and putting CE inside containers</span><span>
</span><a name="line-10"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#getValueOrThrowErrorsNCE"><span class="hs-identifier hs-var">getValueOrThrowErrorsNCE</span></a><span>
</span><a name="line-12"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift1CE"><span class="hs-identifier hs-var">lift1CE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2CE"><span class="hs-identifier hs-var">lift2CE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2TCE"><span class="hs-identifier hs-var">lift2TCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2TLCE"><span class="hs-identifier hs-var">lift2TLCE</span></a><span>
</span><a name="line-13"></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">error</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">const</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Either</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Printf</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Convertible</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- import Language.Haskell.TH</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">{-|
  A wrapper around values which can accommodate a list of
  (potential) errors that have (maybe) occurred during the computation
  of a value.  A value may be missing, leaving only the error(s).

  Such error collection allows one to write expressions with partial
  functions (ie functions that fail for some inputs) instead of
  branching after each application of such function.
  Dealing with the errors can be moved outside the expression.
  If the error data contain enough information, their list can be used
  to trace the source of the errors.
-}</span><span>
</span><a name="line-45"></a><span class="hs-keyword">data</span><span> </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span> </span><a name="local-6989586621679063145"><a href="#local-6989586621679063145"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679063146"><a href="#local-6989586621679063146"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>  </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="getMaybeValueCE"><a href="Control.CollectErrors.html#getMaybeValueCE"><span class="hs-identifier">getMaybeValueCE</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679063146"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="getErrorsCE"><a href="Control.CollectErrors.html#getErrorsCE"><span class="hs-identifier">getErrorsCE</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679063145"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">type</span><span> </span><a name="SuitableForCE"><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier">SuitableForCE</span></a></a><span> </span><a name="local-6989586621679063144"><a href="#local-6989586621679063144"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679063144"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679063144"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063144"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063582"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063583"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063583"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063582"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>  </span><a name="local-8214565720323784721"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063584"><a href="#local-6989586621679063584"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063585"><a href="#local-6989586621679063585"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063584"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-55"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063586"><a href="#local-6989586621679063586"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063585"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679063586"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-56"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;{%s}&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679063585"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">noValueCE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679063436"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063436"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063437"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-59"></a><a name="noValueCE"><a href="Control.CollectErrors.html#noValueCE"><span class="hs-identifier">noValueCE</span></a></a><span> </span><a name="local-6989586621679063438"><a href="#local-6989586621679063438"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679063438"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-identifier">prependErrorsCE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679063434"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679063434"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063434"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063435"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063434"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063435"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-62"></a><a name="prependErrorsCE"><a href="Control.CollectErrors.html#prependErrorsCE"><span class="hs-identifier">prependErrorsCE</span></a></a><span> </span><a name="local-6989586621679063439"><a href="#local-6989586621679063439"><span class="hs-identifier">es1</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063440"><a href="#local-6989586621679063440"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063441"><a href="#local-6989586621679063441"><span class="hs-identifier">es2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a href="#local-6989586621679063440"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063439"><span class="hs-identifier hs-var">es1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679063441"><span class="hs-identifier hs-var">es2</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">ce2ConvertResult</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679063169"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063169"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063170"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-67"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063170"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063169"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">ConvertError</span><span> </span><a href="#local-6989586621679063169"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-68"></a><a name="ce2ConvertResult"><a href="Control.CollectErrors.html#ce2ConvertResult"><span class="hs-identifier">ce2ConvertResult</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063442"><a href="#local-6989586621679063442"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063443"><a href="#local-6989586621679063443"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063442"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063444"><a href="#local-6989586621679063444"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063443"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679063444"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">convError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679063443"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063442"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">{-| A safe way to get a value out of the CollectErrors wrapper. -}</span><span>
</span><a name="line-74"></a><span class="hs-identifier">getValueIfNoErrorCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063166"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-77"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063166"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063167"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063167"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063168"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063166"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063168"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063168"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-78"></a><a name="getValueIfNoErrorCE"><a href="Control.CollectErrors.html#getValueIfNoErrorCE"><span class="hs-identifier">getValueIfNoErrorCE</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063445"><a href="#local-6989586621679063445"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063446"><a href="#local-6989586621679063446"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063447"><a href="#local-6989586621679063447"><span class="hs-identifier">withValue</span></a></a><span> </span><a name="local-6989586621679063448"><a href="#local-6989586621679063448"><span class="hs-identifier">withErrors</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063445"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063449"><a href="#local-6989586621679063449"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063446"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063447"><span class="hs-identifier hs-var">withValue</span></a><span> </span><a href="#local-6989586621679063449"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063448"><span class="hs-identifier hs-var">withErrors</span></a><span> </span><a href="#local-6989586621679063446"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">filterValuesWithoutErrorCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063164"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">[</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063164"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063165"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679063165"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-87"></a><a name="filterValuesWithoutErrorCE"><a href="Control.CollectErrors.html#filterValuesWithoutErrorCE"><span class="hs-identifier">filterValuesWithoutErrorCE</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-88"></a><span class="hs-identifier">filterValuesWithoutErrorCE</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063450"><a href="#local-6989586621679063450"><span class="hs-identifier">vCE</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679063451"><a href="#local-6989586621679063451"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-89"></a><span>  </span><a href="Control.CollectErrors.html#getValueIfNoErrorCE"><span class="hs-identifier hs-var">getValueIfNoErrorCE</span></a><span> </span><a href="#local-6989586621679063450"><span class="hs-identifier hs-var">vCE</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679063452"><span class="hs-identifier hs-var">restDone</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679063452"><span class="hs-identifier hs-var">restDone</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>  </span><a name="local-6989586621679063452"><a href="#local-6989586621679063452"><span class="hs-identifier">restDone</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#filterValuesWithoutErrorCE"><span class="hs-identifier hs-var">filterValuesWithoutErrorCE</span></a><span> </span><a href="#local-6989586621679063451"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- functor instances:</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063578"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>  </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679063579"><a href="#local-6989586621679063579"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063580"><a href="#local-6989586621679063580"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063581"><a href="#local-6989586621679063581"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-97"></a><span>    </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679063579"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063580"><span class="hs-identifier hs-var">mv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063581"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679063570"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063570"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-100"></a><span>  </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><a name="local-6989586621679063571"><a href="#local-6989586621679063571"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063571"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063572"><a href="#local-6989586621679063572"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063573"><a href="#local-6989586621679063573"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063574"><a href="#local-6989586621679063574"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063575"><a href="#local-6989586621679063575"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-102"></a><span>    </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063572"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679063574"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063573"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679063575"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063576"><a href="#local-6989586621679063576"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063577"><a href="#local-6989586621679063577"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-104"></a><span>    </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063576"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679063577"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679063562"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063562"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>  </span><a name="local-6989586621679063563"><a href="#local-6989586621679063563"><span class="hs-identifier">ae</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679063564"><a href="#local-6989586621679063564"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063563"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-109"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063565"><a href="#local-6989586621679063565"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063566"><a href="#local-6989586621679063566"><span class="hs-identifier">es1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-110"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063567"><a href="#local-6989586621679063567"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063568"><a href="#local-6989586621679063568"><span class="hs-identifier">es2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063564"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063565"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-111"></a><span>          </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a href="#local-6989586621679063567"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063566"><span class="hs-identifier hs-var">es1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679063568"><span class="hs-identifier hs-var">es2</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679063569"><a href="#local-6989586621679063569"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-113"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679063569"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679063559"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679063560"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063560"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063559"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-116"></a><span>  </span><a name="local-8214565720323785409"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679063561"><a href="#local-6989586621679063561"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063561"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-|
  A mechanism for adding and removing CollectErrors
  to a type in a manner that depends on
  the shape of the type, especially whether
  it already has CollectErrors.
-}</span><span>
</span><a name="line-124"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="CanEnsureCE"><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier">CanEnsureCE</span></a></a><span> </span><a name="local-6989586621679062754"><a href="#local-6989586621679062754"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679062755"><a href="#local-6989586621679062755"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-comment">{-|
    Add CollectErrors to a type except when the type already
    has CollectErrors in it.
  -}</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureCE</span><span> </span><a name="local-6989586621679062754"><a href="#local-6989586621679062754"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679062755"><a href="#local-6989586621679062755"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureCE</span><span> </span><a name="local-6989586621679062756"><a href="#local-6989586621679062756"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679062757"><a href="#local-6989586621679062757"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679062756"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062757"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- default</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureNoCE</span><span> </span><a name="local-6989586621679062754"><a href="#local-6989586621679062754"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679062755"><a href="#local-6989586621679062755"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-132"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureNoCE</span><span> </span><a name="local-6989586621679062758"><a href="#local-6989586621679062758"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679062759"><a href="#local-6989586621679062759"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062759"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- default</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>  </span><span class="hs-comment">{-|
    Translate a value of a type @a@
    to a value of a type @EnsureCE es a@.
  -}</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-identifier">ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-140"></a><span>    </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-145"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-146"></a><span>    </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-147"></a><span>  </span><a name="local-8214565720323835828"><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier">ensureCE</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>  </span><span class="hs-identifier">deEnsureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-151"></a><span>    </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">deEnsureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-156"></a><span>    </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-157"></a><span>  </span><a name="local-8214565720323835829"><a href="Control.CollectErrors.html#deEnsureCE"><span class="hs-identifier">deEnsureCE</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063141"><a href="#local-6989586621679063141"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063142"><a href="#local-6989586621679063142"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063141"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-159"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063143"><a href="#local-6989586621679063143"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063142"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679063143"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-160"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679063142"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-identifier">ensureNoCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-164"></a><span>    </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureNoCE"><span class="hs-identifier hs-type">EnsureNoCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">ensureNoCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureNoCE"><span class="hs-identifier hs-type">EnsureNoCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-169"></a><span>    </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureNoCE"><span class="hs-identifier hs-type">EnsureNoCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>  </span><a name="local-8214565720323835830"><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier">ensureNoCE</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-comment">{-|  Make CollectErrors record with no value, only errors. -}</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-identifier">noValueECE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-175"></a><span>    </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">noValueECE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-181"></a><span>    </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679062754"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-182"></a><span>  </span><a name="local-8214565720323835831"><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier">noValueECE</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noValueCE"><span class="hs-identifier hs-var">noValueCE</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- instance for CollectErrors a:</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-189"></a><span>  </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureCE</span><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-192"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureNoCE</span><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063549"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063550"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>  </span><a name="local-8214565720323835828"><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier">ensureCE</span></a></a><span> </span><a name="local-6989586621679063551"><a href="#local-6989586621679063551"><span class="hs-identifier">_sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-195"></a><span>  </span><a name="local-8214565720323835829"><a href="Control.CollectErrors.html#deEnsureCE"><span class="hs-identifier">deEnsureCE</span></a></a><span> </span><a name="local-6989586621679063552"><a href="#local-6989586621679063552"><span class="hs-identifier">_sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-196"></a><span>  </span><a name="local-8214565720323835830"><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier">ensureNoCE</span></a></a><span> </span><a name="local-6989586621679063553"><a href="#local-6989586621679063553"><span class="hs-identifier">_sample_es</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063554"><a href="#local-6989586621679063554"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679063555"><a href="#local-6989586621679063555"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679063554"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063556"><a href="#local-6989586621679063556"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679063555"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679063556"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679063555"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span>  </span><a name="local-8214565720323835831"><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier">noValueECE</span></a></a><span> </span><a name="local-6989586621679063557"><a href="#local-6989586621679063557"><span class="hs-identifier">_sample_vCE</span></a></a><span> </span><a name="local-6989586621679063558"><a href="#local-6989586621679063558"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679063558"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- instances for ground types, using the default implementations:</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063548"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-206"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063547"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063547"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-207"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063546"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063546"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-208"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063545"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063545"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-209"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063544"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063544"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-210"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063543"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063543"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-211"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063542"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063542"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- instance for Maybe a:</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-keyword">instance</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-218"></a><span>  </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureCE</span><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EnsureNoCE</span><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureNoCE"><span class="hs-identifier hs-type">EnsureNoCE</span></a><span> </span><a href="#local-6989586621679063531"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>  </span><a name="local-8214565720323835828"><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier">ensureCE</span></a></a><span> </span><a name="local-6989586621679063533"><a href="#local-6989586621679063533"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><a href="#local-6989586621679063533"><span class="hs-identifier hs-var">sample_es</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>  </span><a name="local-8214565720323835829"><a href="Control.CollectErrors.html#deEnsureCE"><span class="hs-identifier">deEnsureCE</span></a></a><span> </span><a name="local-6989586621679063534"><a href="#local-6989586621679063534"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063535"><a href="#local-6989586621679063535"><span class="hs-identifier">vCE</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#deEnsureCE"><span class="hs-identifier hs-var">deEnsureCE</span></a><span> </span><a href="#local-6989586621679063534"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063535"><span class="hs-identifier hs-var">vCE</span></a><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-identifier">deEnsureCE</span><span> </span><a name="local-6989586621679063536"><a href="#local-6989586621679063536"><span class="hs-identifier">_sample_es</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-226"></a><span>  </span><a name="local-8214565720323835830"><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier">ensureNoCE</span></a></a><span> </span><a name="local-6989586621679063537"><a href="#local-6989586621679063537"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679063538"><a href="#local-6989586621679063538"><span class="hs-identifier">vCE</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063537"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063538"><span class="hs-identifier hs-var">vCE</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-identifier">ensureNoCE</span><span> </span><a name="local-6989586621679063539"><a href="#local-6989586621679063539"><span class="hs-identifier">_sample_es</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span>  </span><a name="local-8214565720323835831"><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier">noValueECE</span></a></a><span> </span><a name="local-6989586621679063540"><a href="#local-6989586621679063540"><span class="hs-identifier">sample_vCE</span></a></a><span> </span><a name="local-6989586621679063541"><a href="#local-6989586621679063541"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier hs-var">noValueECE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679063540"><span class="hs-identifier hs-var">sample_vCE</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063541"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- instance (Monoid es) =&gt; CanEnsureCE es [a] where</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- instance (Monoid es) =&gt; CanEnsureCE es (Either e a) where</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">{-| An unsafe way to get a value out of an CollectErrors wrapper. -}</span><span>
</span><a name="line-235"></a><span class="hs-identifier">getValueOrThrowErrorsNCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063162"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063162"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063163"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679063163"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679063162"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-comment">{-^ sample only -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-239"></a><span>  </span><a href="#local-6989586621679063163"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureNoCE"><span class="hs-identifier hs-type">EnsureNoCE</span></a><span> </span><a href="#local-6989586621679063162"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063163"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><a name="getValueOrThrowErrorsNCE"><a href="Control.CollectErrors.html#getValueOrThrowErrorsNCE"><span class="hs-identifier">getValueOrThrowErrorsNCE</span></a></a><span> </span><a name="local-6989586621679063453"><a href="#local-6989586621679063453"><span class="hs-identifier">sample_es</span></a></a><span> </span><a name="local-6989586621679063454"><a href="#local-6989586621679063454"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063453"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063454"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679063455"><a href="#local-6989586621679063455"><span class="hs-identifier">vNCE</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063455"><span class="hs-identifier hs-var">vNCE</span></a><span>
</span><a name="line-243"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679063456"><a href="#local-6989586621679063456"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679063456"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">{-|
  Add error collection support to an unary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-249"></a><span class="hs-identifier">lift1CE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063159"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-251"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063159"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063160"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679063161"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063160"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063159"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063161"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679063159"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063160"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><a name="lift1CE"><a href="Control.CollectErrors.html#lift1CE"><span class="hs-identifier">lift1CE</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679063489"><a href="#local-6989586621679063489"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679063487"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063488"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063490"><a href="#local-6989586621679063490"><span class="hs-identifier">aCE</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063491"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063490"><span class="hs-identifier hs-var">aCE</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-257"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679063504"><a href="#local-6989586621679063504"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><a href="#local-6989586621679063491"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679063489"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679063504"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-258"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier hs-var">noValueECE</span></a><span> </span><a href="#local-6989586621679063494"><span class="hs-identifier hs-var">sample_c</span></a><span> </span><a href="#local-6989586621679063493"><span class="hs-identifier hs-var">a_es</span></a><span>
</span><a name="line-259"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-260"></a><span>  </span><a name="local-6989586621679063491"><a href="#local-6989586621679063491"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063493"><span class="hs-identifier hs-var">a_es</span></a><span>
</span><a name="line-261"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063492"><a href="#local-6989586621679063492"><span class="hs-identifier">ma</span></a></a><span> </span><a name="local-6989586621679063493"><a href="#local-6989586621679063493"><span class="hs-identifier">a_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063490"><span class="hs-identifier hs-var">aCE</span></a><span>
</span><a name="line-262"></a><span>  </span><a name="local-6989586621679063494"><a href="#local-6989586621679063494"><span class="hs-identifier">sample_c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063489"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679063492"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-268"></a><span class="hs-identifier">lift2CE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063155"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-270"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063155"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063156"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679063157"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063158"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063156"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063155"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063157"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063155"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063158"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679063155"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063156"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><a name="lift2CE"><a href="Control.CollectErrors.html#lift2CE"><span class="hs-identifier">lift2CE</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679063508"><a href="#local-6989586621679063508"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679063505"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063506"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063507"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063509"><a href="#local-6989586621679063509"><span class="hs-identifier">aCE</span></a></a><span> </span><a name="local-6989586621679063510"><a href="#local-6989586621679063510"><span class="hs-identifier">bCE</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063511"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063509"><span class="hs-identifier hs-var">aCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063511"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063510"><span class="hs-identifier hs-var">bCE</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-276"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679063517"><a href="#local-6989586621679063517"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679063518"><a href="#local-6989586621679063518"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><a href="#local-6989586621679063511"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679063508"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679063517"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679063518"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-277"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier hs-var">noValueECE</span></a><span> </span><a href="#local-6989586621679063516"><span class="hs-identifier hs-var">sample_c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063513"><span class="hs-identifier hs-var">a_es</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679063515"><span class="hs-identifier hs-var">b_es</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-279"></a><span>  </span><a name="local-6989586621679063511"><a href="#local-6989586621679063511"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063513"><span class="hs-identifier hs-var">a_es</span></a><span>
</span><a name="line-280"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063512"><a href="#local-6989586621679063512"><span class="hs-identifier">ma</span></a></a><span> </span><a name="local-6989586621679063513"><a href="#local-6989586621679063513"><span class="hs-identifier">a_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063509"><span class="hs-identifier hs-var">aCE</span></a><span>
</span><a name="line-281"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063514"><a href="#local-6989586621679063514"><span class="hs-identifier">mb</span></a></a><span> </span><a name="local-6989586621679063515"><a href="#local-6989586621679063515"><span class="hs-identifier">b_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063510"><span class="hs-identifier hs-var">bCE</span></a><span>
</span><a name="line-282"></a><span>  </span><a name="local-6989586621679063516"><a href="#local-6989586621679063516"><span class="hs-identifier">sample_c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063508"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679063512"><span class="hs-identifier hs-var">ma</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679063514"><span class="hs-identifier hs-var">mb</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
  A version where the second operand is not lifted, only the first one.
-}</span><span>
</span><a name="line-289"></a><span class="hs-identifier">lift2TCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063151"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-291"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063151"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063152"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679063153"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063154"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063152"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063151"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063153"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063154"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679063151"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063152"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><a name="lift2TCE"><a href="Control.CollectErrors.html#lift2TCE"><span class="hs-identifier">lift2TCE</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679063522"><a href="#local-6989586621679063522"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679063519"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063520"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063521"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679063523"><a href="#local-6989586621679063523"><span class="hs-identifier">aCE</span></a></a><span> </span><a name="local-6989586621679063524"><a href="#local-6989586621679063524"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureNoCE"><span class="hs-identifier hs-var">ensureNoCE</span></a><span> </span><a href="#local-6989586621679063525"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><a href="#local-6989586621679063523"><span class="hs-identifier hs-var">aCE</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679063529"><a href="#local-6989586621679063529"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><a href="#local-6989586621679063525"><span class="hs-identifier hs-var">sample_es</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679063522"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679063529"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679063524"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-298"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#noValueECE"><span class="hs-identifier hs-var">noValueECE</span></a><span> </span><a href="#local-6989586621679063528"><span class="hs-identifier hs-var">sample_c</span></a><span> </span><a href="#local-6989586621679063527"><span class="hs-identifier hs-var">a_es</span></a><span>
</span><a name="line-299"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-300"></a><span>  </span><a name="local-6989586621679063525"><a href="#local-6989586621679063525"><span class="hs-identifier">sample_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063527"><span class="hs-identifier hs-var">a_es</span></a><span>
</span><a name="line-301"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679063526"><a href="#local-6989586621679063526"><span class="hs-identifier">ma</span></a></a><span> </span><a name="local-6989586621679063527"><a href="#local-6989586621679063527"><span class="hs-identifier">a_es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063523"><span class="hs-identifier hs-var">aCE</span></a><span>
</span><a name="line-302"></a><span>  </span><a name="local-6989586621679063528"><a href="#local-6989586621679063528"><span class="hs-identifier">sample_c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063522"><span class="hs-identifier hs-var">fn</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679063526"><span class="hs-identifier hs-var">ma</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679063524"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
  A version where the first operand is not lifted, only the second one.
-}</span><span>
</span><a name="line-309"></a><span class="hs-identifier">lift2TLCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#SuitableForCE"><span class="hs-identifier hs-type">SuitableForCE</span></a><span> </span><a href="#local-6989586621679063147"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-311"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679063147"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063148"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679063149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063150"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063148"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-314"></a><span>  </span><a href="#local-6989586621679063149"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679063147"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063150"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679063147"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679063148"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-315"></a><a name="lift2TLCE"><a href="Control.CollectErrors.html#lift2TLCE"><span class="hs-identifier">lift2TLCE</span></a></a><span> </span><a name="local-6989586621679063530"><a href="#local-6989586621679063530"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Control.CollectErrors.html#lift2TCE"><span class="hs-identifier hs-var">lift2TCE</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679063530"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a></pre></body></html>