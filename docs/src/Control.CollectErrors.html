<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">CollectErrors</span><span>
</span><a name="line-2"></a><span class="hs-special">(</span><span>
</span><a name="line-3"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#noValue"><span class="hs-identifier hs-var">noValue</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#ifError"><span class="hs-identifier hs-var">ifError</span></a><span>
</span><a name="line-5"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift1"><span class="hs-identifier hs-var">lift1</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier hs-var">lift2</span></a><span>
</span><a name="line-6"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#unlift2first"><span class="hs-identifier hs-var">unlift2first</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#unlift2second"><span class="hs-identifier hs-var">unlift2second</span></a><span>
</span><a name="line-7"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#ensureCollectErrors"><span class="hs-identifier hs-var">ensureCollectErrors</span></a><span>
</span><a name="line-8"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCollectErrors"><span class="hs-identifier hs-type">CanEnsureCollectErrors</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#EnsureCollectErrors"><span class="hs-identifier hs-type">EnsureCollectErrors</span></a><span>
</span><a name="line-9"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift1ensureCE"><span class="hs-identifier hs-var">lift1ensureCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2ensureCE"><span class="hs-identifier hs-var">lift2ensureCE</span></a><span>
</span><a name="line-10"></a><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">where</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Control.EnsureTypeOp.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">EnsureTypeOp</span></a><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">{-|
  A wrapper around values which can accommodate a list of
  (potential) errors that have (maybe) occurred during the computation
  of a value.  A value may be missing, leaving only the error(s).

  Such error collectoin allows one to write expressions with partial
  functions (ie functions that fail for some inputs) instead of
  branching after each application of such function.
  Dealing with the errors can be moved outside the expression.
  If the error data contain enough information, their list can be used
  to trace the source of the errors.
-}</span><span>
</span><a name="line-30"></a><span class="hs-keyword">data</span><span> </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span> </span><a name="local-6989586621679067046"><a href="#local-6989586621679067046"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679067047"><a href="#local-6989586621679067047"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-31"></a><span>  </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679067047"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679067046"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- utilities:</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">{-|  Wrap a pure value in a CollectErrors record -}</span><span>
</span><a name="line-37"></a><span class="hs-identifier">noErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067079"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679067080"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067079"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067080"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-38"></a><a name="noErrors"><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier">noErrors</span></a></a><span> </span><a name="local-6989586621679067081"><a href="#local-6989586621679067081"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679067081"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">{-|  Make CollectErrors record with no value, only errors. -}</span><span>
</span><a name="line-41"></a><span class="hs-identifier">noValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679067077"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067077"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067078"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-42"></a><a name="noValue"><a href="Control.CollectErrors.html#noValue"><span class="hs-identifier">noValue</span></a></a><span> </span><a name="local-6989586621679067082"><a href="#local-6989586621679067082"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679067082"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">{-|  Add further errors into a CollectErrors record. -}</span><span>
</span><a name="line-45"></a><span class="hs-identifier">prependErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067075"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679067075"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067075"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067076"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067075"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067076"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-46"></a><a name="prependErrors"><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier">prependErrors</span></a></a><span> </span><a name="local-6989586621679067083"><a href="#local-6989586621679067083"><span class="hs-identifier">es1</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679067084"><a href="#local-6989586621679067084"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679067085"><a href="#local-6989586621679067085"><span class="hs-identifier">es2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a href="#local-6989586621679067084"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067083"><span class="hs-identifier hs-var">es1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679067085"><span class="hs-identifier hs-var">es2</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">ifError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067072"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679067072"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067072"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067073"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067072"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067073"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067074"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067073"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067074"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067074"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-49"></a><a name="ifError"><a href="Control.CollectErrors.html#ifError"><span class="hs-identifier">ifError</span></a></a><span> </span><a name="local-6989586621679067086"><a href="#local-6989586621679067086"><span class="hs-identifier">ce</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679067087"><a href="#local-6989586621679067087"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679067088"><a href="#local-6989586621679067088"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067089"><a href="#local-6989586621679067089"><span class="hs-identifier">onError</span></a></a><span> </span><a name="local-6989586621679067090"><a href="#local-6989586621679067090"><span class="hs-identifier">onValue</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679067087"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067091"><a href="#local-6989586621679067091"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679067088"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067090"><span class="hs-identifier hs-var">onValue</span></a><span> </span><a href="#local-6989586621679067091"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067089"><span class="hs-identifier hs-var">onError</span></a><span> </span><a href="#local-6989586621679067086"><span class="hs-identifier hs-var">ce</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">{-|
  Add error collection support to an unary operation.
-}</span><span>
</span><a name="line-57"></a><span class="hs-identifier">lift1</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679067069"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067070"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067071"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067069"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067071"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067070"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><a name="lift1"><a href="Control.CollectErrors.html#lift1"><span class="hs-identifier">lift1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{-|
  Add error collection support to a binary operation.
-}</span><span>
</span><a name="line-65"></a><span class="hs-identifier">lift2</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067065"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679067066"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067067"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067068"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067065"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067066"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067065"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067067"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067065"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067068"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><a name="lift2"><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier">lift2</span></a></a><span> </span><a name="local-6989586621679067092"><a href="#local-6989586621679067092"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067093"><a href="#local-6989586621679067093"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067094"><a href="#local-6989586621679067094"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067095"><a href="#local-6989586621679067095"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067096"><a href="#local-6989586621679067096"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-71"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067092"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679067093"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679067095"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067094"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679067096"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-identifier">lift2</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067097"><a href="#local-6989586621679067097"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067098"><a href="#local-6989586621679067098"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-74"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067097"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679067098"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">{-|
  An utility function for easily defining a binary function with
  only the second parameter collecting errors, if we have an analogous
  function that requires both parameters to collect errors.
-}</span><span>
</span><a name="line-81"></a><span class="hs-identifier">unlift2first</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067061"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067061"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067062"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067061"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067063"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067064"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679067062"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067061"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067063"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067064"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><a name="unlift2first"><a href="Control.CollectErrors.html#unlift2first"><span class="hs-identifier">unlift2first</span></a></a><span> </span><a name="local-6989586621679067099"><a href="#local-6989586621679067099"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679067101"><a href="#local-6989586621679067101"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679067100"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679067104"><a href="#local-6989586621679067104"><span class="hs-identifier">be</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067102"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067103"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-88"></a><span>  </span><a href="#local-6989586621679067099"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span> </span><a href="#local-6989586621679067101"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067102"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067100"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679067104"><span class="hs-identifier hs-var">be</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">{-|
  An utility function for easily defining a binary function with
  only the first parameter collecting errors, if we have an analogous
  function that requires both parameters to collect errors.
-}</span><span>
</span><a name="line-95"></a><span class="hs-identifier">unlift2second</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067057"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067057"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067058"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067057"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067059"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067060"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067057"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067058"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067059"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067060"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><a name="unlift2second"><a href="Control.CollectErrors.html#unlift2second"><span class="hs-identifier">unlift2second</span></a></a><span> </span><a name="local-6989586621679067105"><a href="#local-6989586621679067105"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679067108"><a href="#local-6989586621679067108"><span class="hs-identifier">ae</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067106"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679067110"><a href="#local-6989586621679067110"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679067109"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-102"></a><span>  </span><a href="#local-6989586621679067105"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679067108"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span> </span><a href="#local-6989586621679067110"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067106"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067109"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- functor instances:</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067141"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>  </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679067142"><a href="#local-6989586621679067142"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679067143"><a href="#local-6989586621679067143"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679067144"><a href="#local-6989586621679067144"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-108"></a><span>    </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679067142"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679067143"><span class="hs-identifier hs-var">mv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679067144"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067140"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067140"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-111"></a><span>  </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier hs-var">lift2</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067134"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067134"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>  </span><a name="local-6989586621679067135"><a href="#local-6989586621679067135"><span class="hs-identifier">ae</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679067136"><a href="#local-6989586621679067136"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679067135"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-117"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067137"><a href="#local-6989586621679067137"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067138"><a href="#local-6989586621679067138"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-118"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><a href="#local-6989586621679067138"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067136"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679067137"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067139"><a href="#local-6989586621679067139"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-120"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679067139"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">{-|
  Apply CollectErrors to a type except when the type already
  is a CollectErrors type.
-}</span><span>
</span><a name="line-127"></a><span class="hs-keyword">type</span><span> </span><a name="EnsureCollectErrors"><a href="Control.CollectErrors.html#EnsureCollectErrors"><span class="hs-identifier">EnsureCollectErrors</span></a></a><span> </span><a name="local-6989586621679067044"><a href="#local-6989586621679067044"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679067045"><a href="#local-6989586621679067045"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#EnsureTypeOp"><span class="hs-identifier hs-type">EnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067044"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679067045"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">{-|
  Translate a value of a type @a@
  to a value of a type @CollectErrors es a@ except when @a@
  already is a @CollectErrors@ type, in which case the value is left as is.
-}</span><span>
</span><a name="line-134"></a><span class="hs-identifier">ensureCollectErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CanEnsureCollectErrors"><span class="hs-identifier hs-type">CanEnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067055"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067056"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679067056"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#EnsureCollectErrors"><span class="hs-identifier hs-type">EnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067055"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067056"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-135"></a><a name="ensureCollectErrors"><a href="Control.CollectErrors.html#ensureCollectErrors"><span class="hs-identifier">ensureCollectErrors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier hs-var">ensureTypeOp</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-keyword">type</span><span> </span><a name="CanEnsureCollectErrors"><a href="Control.CollectErrors.html#CanEnsureCollectErrors"><span class="hs-identifier">CanEnsureCollectErrors</span></a></a><span> </span><a name="local-6989586621679067042"><a href="#local-6989586621679067042"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679067043"><a href="#local-6989586621679067043"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067042"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679067043"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067133"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067133"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-141"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067132"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067132"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067131"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067131"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-145"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067130"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067130"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-146"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-147"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067129"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067129"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-149"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067127"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067127"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679067128"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067125"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067125"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679067126"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-153"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067122"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067122"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679067123"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679067124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-154"></a><span>  </span><a name="local-8214565720323840710"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-160"></a><span class="hs-identifier">lift1ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067052"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCollectErrors"><span class="hs-identifier hs-type">CanEnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067052"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067053"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679067054"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067053"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067052"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067054"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCollectErrors"><span class="hs-identifier hs-type">EnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067052"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067053"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><a name="lift1ensureCE"><a href="Control.CollectErrors.html#lift1ensureCE"><span class="hs-identifier">lift1ensureCE</span></a></a><span> </span><a name="local-6989586621679067111"><a href="#local-6989586621679067111"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-165"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067112"><a href="#local-6989586621679067112"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067113"><a href="#local-6989586621679067113"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-166"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><a href="#local-6989586621679067113"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureCollectErrors"><span class="hs-identifier hs-var">ensureCollectErrors</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679067111"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679067112"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span class="hs-identifier">lift1ensureCE</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067114"><a href="#local-6989586621679067114"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-169"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679067114"><span class="hs-identifier hs-var">ae</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-175"></a><span class="hs-identifier">lift2ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679067048"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCollectErrors"><span class="hs-identifier hs-type">CanEnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067048"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067049"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679067050"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067051"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067049"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067048"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067050"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679067048"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067051"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCollectErrors"><span class="hs-identifier hs-type">EnsureCollectErrors</span></a><span> </span><a href="#local-6989586621679067048"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679067049"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><a name="lift2ensureCE"><a href="Control.CollectErrors.html#lift2ensureCE"><span class="hs-identifier">lift2ensureCE</span></a></a><span> </span><a name="local-6989586621679067115"><a href="#local-6989586621679067115"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067116"><a href="#local-6989586621679067116"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067117"><a href="#local-6989586621679067117"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679067118"><a href="#local-6989586621679067118"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679067119"><a href="#local-6989586621679067119"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-181"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067117"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679067119"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureCollectErrors"><span class="hs-identifier hs-var">ensureCollectErrors</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679067115"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679067116"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679067118"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span class="hs-identifier">lift2ensureCE</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067120"><a href="#local-6989586621679067120"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679067121"><a href="#local-6989586621679067121"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-184"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679067120"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679067121"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a></pre></body></html>