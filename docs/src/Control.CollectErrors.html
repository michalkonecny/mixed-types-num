<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">CollectErrors</span><span>
</span><a name="line-3"></a><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- * Monad for collecting errors in expressions</span><span>
</span><a name="line-5"></a><span>  </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#noValue"><span class="hs-identifier hs-var">noValue</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span>
</span><a name="line-7"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#getValueIfNoError"><span class="hs-identifier hs-var">getValueIfNoError</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#getValueOrThrowErrors"><span class="hs-identifier hs-var">getValueOrThrowErrors</span></a><span> </span><span class="hs-comment">--, caseErrors</span><span>
</span><a name="line-8"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift1"><span class="hs-identifier hs-var">lift1</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier hs-var">lift2</span></a><span>
</span><a name="line-9"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#unlift2first"><span class="hs-identifier hs-var">unlift2first</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#unlift2second"><span class="hs-identifier hs-var">unlift2second</span></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- * Tools for avoiding @CollectErrors(CollectErrors t)@</span><span>
</span><a name="line-11"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span>
</span><a name="line-12"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#WithoutCE"><span class="hs-identifier hs-type">WithoutCE</span></a><span>
</span><a name="line-13"></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift1ensureCE"><span class="hs-identifier hs-var">lift1ensureCE</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#lift2ensureCE"><span class="hs-identifier hs-var">lift2ensureCE</span></a><span>
</span><a name="line-14"></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- import Language.Haskell.TH</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Control.EnsureTypeOp.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">EnsureTypeOp</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">{-|
  A wrapper around values which can accommodate a list of
  (potential) errors that have (maybe) occurred during the computation
  of a value.  A value may be missing, leaving only the error(s).

  Such error collection allows one to write expressions with partial
  functions (ie functions that fail for some inputs) instead of
  branching after each application of such function.
  Dealing with the errors can be moved outside the expression.
  If the error data contain enough information, their list can be used
  to trace the source of the errors.
-}</span><span>
</span><a name="line-38"></a><span class="hs-keyword">data</span><span> </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span> </span><a name="local-6989586621679047249"><a href="#local-6989586621679047249"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679047250"><a href="#local-6989586621679047250"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-39"></a><span>  </span><a name="CollectErrors"><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier">CollectErrors</span></a></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">{</span><span>
</span><a name="line-41"></a><span>    </span><a name="getMaybeValue"><a href="Control.CollectErrors.html#getMaybeValue"><span class="hs-identifier">getMaybeValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679047250"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="getErrors"><a href="Control.CollectErrors.html#getErrors"><span class="hs-identifier">getErrors</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047249"><span class="hs-identifier hs-type">es</span></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- utilities:</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">{-|  Wrap a pure value in a CollectErrors record -}</span><span>
</span><a name="line-49"></a><span class="hs-identifier">noErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047862"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047863"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047862"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047863"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-50"></a><a name="noErrors"><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier">noErrors</span></a></a><span> </span><a name="local-6989586621679047864"><a href="#local-6989586621679047864"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679047864"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">{-|  Make CollectErrors record with no value, only errors. -}</span><span>
</span><a name="line-53"></a><span class="hs-identifier">noValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047860"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047860"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047861"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-54"></a><a name="noValue"><a href="Control.CollectErrors.html#noValue"><span class="hs-identifier">noValue</span></a></a><span> </span><a name="local-6989586621679047865"><a href="#local-6989586621679047865"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679047865"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">{-|  Add further errors into a CollectErrors record. -}</span><span>
</span><a name="line-57"></a><span class="hs-identifier">prependErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047858"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047858"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047858"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047859"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047858"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047859"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-58"></a><a name="prependErrors"><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier">prependErrors</span></a></a><span> </span><a name="local-6989586621679047866"><a href="#local-6989586621679047866"><span class="hs-identifier">es1</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679047867"><a href="#local-6989586621679047867"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679047868"><a href="#local-6989586621679047868"><span class="hs-identifier">es2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a href="#local-6989586621679047867"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047866"><span class="hs-identifier hs-var">es1</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679047868"><span class="hs-identifier hs-var">es2</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{-| A safe way to get a value out of the CollectErrors wrapper. -}</span><span>
</span><a name="line-61"></a><span class="hs-identifier">getValueIfNoError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047855"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679047855"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047855"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047856"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047856"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047857"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047855"><span class="hs-identifier hs-type">es</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047857"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047857"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-62"></a><a name="getValueIfNoError"><a href="Control.CollectErrors.html#getValueIfNoError"><span class="hs-identifier">getValueIfNoError</span></a></a><span> </span><a name="local-6989586621679047869"><a href="#local-6989586621679047869"><span class="hs-identifier">ce</span></a></a><span> </span><a name="local-6989586621679047870"><a href="#local-6989586621679047870"><span class="hs-identifier">withValue</span></a></a><span> </span><a name="local-6989586621679047871"><a href="#local-6989586621679047871"><span class="hs-identifier">withErrors</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getMaybeValue</span><span> </span><a href="#local-6989586621679047869"><span class="hs-identifier hs-var">ce</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">getErrors</span><span> </span><a href="#local-6989586621679047869"><span class="hs-identifier hs-var">ce</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047872"><a href="#local-6989586621679047872"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047873"><a href="#local-6989586621679047873"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679047873"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047870"><span class="hs-identifier hs-var">withValue</span></a><span> </span><a href="#local-6989586621679047872"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679047874"><a href="#local-6989586621679047874"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047871"><span class="hs-identifier hs-var">withErrors</span></a><span> </span><a href="#local-6989586621679047874"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">{-| An unsafe way to get a value out of the CollectErrors wrapper. -}</span><span>
</span><a name="line-68"></a><span class="hs-identifier">getValueOrThrowErrors</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679047853"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047853"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679047853"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047853"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047854"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047854"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-69"></a><a name="getValueOrThrowErrors"><a href="Control.CollectErrors.html#getValueOrThrowErrors"><span class="hs-identifier">getValueOrThrowErrors</span></a></a><span> </span><a name="local-6989586621679047875"><a href="#local-6989586621679047875"><span class="hs-identifier">ce</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>  </span><a href="Control.CollectErrors.html#getValueIfNoError"><span class="hs-identifier hs-var">getValueIfNoError</span></a><span> </span><a href="#local-6989586621679047875"><span class="hs-identifier hs-var">ce</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- caseErrors :: [((CollectErrors es v) -&gt; Bool, (CollectErrors es v) -&gt; t)] -&gt; t -&gt; (CollectErrors es v) -&gt; t</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- caseErrors cases defaultT ce = aux cases</span><span>
</span><a name="line-74"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-75"></a><span class="hs-comment">--   aux [] = defaultT</span><span>
</span><a name="line-76"></a><span class="hs-comment">--   aux ((cond, comp) : rest)</span><span>
</span><a name="line-77"></a><span class="hs-comment">--     | cond ce = comp ce</span><span>
</span><a name="line-78"></a><span class="hs-comment">--     | otherwise = aux rest</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">{-|
  Add error collection support to an unary operation.
-}</span><span>
</span><a name="line-83"></a><span class="hs-identifier">lift1</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679047850"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047851"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047852"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047850"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047852"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047851"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><a name="lift1"><a href="Control.CollectErrors.html#lift1"><span class="hs-identifier">lift1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">{-|
  Add error collection support to a binary operation.
-}</span><span>
</span><a name="line-91"></a><span class="hs-identifier">lift2</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047846"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679047847"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047848"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047849"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047846"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047847"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047846"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047848"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047846"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047849"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><a name="lift2"><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier">lift2</span></a></a><span> </span><a name="local-6989586621679047910"><a href="#local-6989586621679047910"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047911"><a href="#local-6989586621679047911"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047912"><a href="#local-6989586621679047912"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047913"><a href="#local-6989586621679047913"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047914"><a href="#local-6989586621679047914"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-97"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047910"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679047911"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047913"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047912"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679047914"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-identifier">lift2</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679047915"><a href="#local-6989586621679047915"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679047916"><a href="#local-6989586621679047916"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-100"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047915"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679047916"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">{-|
  An utility function for easily defining a binary function with
  only the second parameter collecting errors, if we have an analogous
  function that requires both parameters to collect errors.
-}</span><span>
</span><a name="line-107"></a><span class="hs-identifier">unlift2first</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047842"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047842"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047843"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047842"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047844"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047845"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679047843"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047842"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047844"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047845"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><a name="unlift2first"><a href="Control.CollectErrors.html#unlift2first"><span class="hs-identifier">unlift2first</span></a></a><span> </span><a name="local-6989586621679047917"><a href="#local-6989586621679047917"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679047919"><a href="#local-6989586621679047919"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047922"><a href="#local-6989586621679047922"><span class="hs-identifier">be</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047920"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047921"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-114"></a><span>  </span><a href="#local-6989586621679047917"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span> </span><a href="#local-6989586621679047919"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047920"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047922"><span class="hs-identifier hs-var">be</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{-|
  An utility function for easily defining a binary function with
  only the first parameter collecting errors, if we have an analogous
  function that requires both parameters to collect errors.
-}</span><span>
</span><a name="line-121"></a><span class="hs-identifier">unlift2second</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047838"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047838"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047839"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047838"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047840"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047841"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-126"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047838"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047839"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047840"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047841"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><a name="unlift2second"><a href="Control.CollectErrors.html#unlift2second"><span class="hs-identifier">unlift2second</span></a></a><span> </span><a name="local-6989586621679047923"><a href="#local-6989586621679047923"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679047926"><a href="#local-6989586621679047926"><span class="hs-identifier">ae</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047924"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047925"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047928"><a href="#local-6989586621679047928"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679047927"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>  </span><a href="#local-6989586621679047923"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679047926"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span> </span><a href="#local-6989586621679047928"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047924"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047927"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- functor instances:</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048635"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-133"></a><span>  </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679048636"><a href="#local-6989586621679048636"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><a name="local-6989586621679048637"><a href="#local-6989586621679048637"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679048638"><a href="#local-6989586621679048638"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-134"></a><span>    </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679048636"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048637"><span class="hs-identifier hs-var">mv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679048638"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048634"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048634"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-137"></a><span>  </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-138"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#lift2"><span class="hs-identifier hs-var">lift2</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048628"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048628"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><a name="local-6989586621679048629"><a href="#local-6989586621679048629"><span class="hs-identifier">ae</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679048630"><a href="#local-6989586621679048630"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679048629"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-143"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679048631"><a href="#local-6989586621679048631"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679048632"><a href="#local-6989586621679048632"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-144"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><a href="#local-6989586621679048632"><span class="hs-identifier hs-var">es</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679048630"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679048631"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>      </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679048633"><a href="#local-6989586621679048633"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-146"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679048633"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679048617"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048618"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048618"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679048617"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720323785409"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">type</span><span> </span><a name="EnsureCE"><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier">EnsureCE</span></a></a><span> </span><a name="local-6989586621679047247"><a href="#local-6989586621679047247"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679047248"><a href="#local-6989586621679047248"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#EnsureTypeOp"><span class="hs-identifier hs-type">EnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047247"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047248"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-152"></a><span class="hs-comment">{-|
Apply CollectErrors to a type except when the type already
is a CollectErrors type.
-}</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">{-|
  Remove CollectErrors wrapper from a type if it is there.
-}</span><span>
</span><a name="line-160"></a><span class="hs-keyword">type</span><span> </span><a name="WithoutCE"><a href="Control.CollectErrors.html#WithoutCE"><span class="hs-identifier">WithoutCE</span></a></a><span> </span><a name="local-6989586621679047245"><a href="#local-6989586621679047245"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679047246"><a href="#local-6989586621679047246"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#RemoveTypeOp"><span class="hs-identifier hs-type">RemoveTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047245"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047246"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">{-|
  Translate a value of a type @a@
  to a value of a type @CollectErrors es a@ except when @a@
  already is a @CollectErrors@ type, in which case the value is left as is.
-}</span><span>
</span><a name="line-167"></a><span class="hs-identifier">ensureCE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679047836"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047837"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679047837"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679047836"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047837"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-168"></a><a name="ensureCE"><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier">ensureCE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier hs-var">ensureTypeOp</span></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-keyword">type</span><span> </span><a name="CanEnsureCE"><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier">CanEnsureCE</span></a></a><span> </span><a name="local-6989586621679047243"><a href="#local-6989586621679047243"><span class="hs-identifier">es</span></a></a><span> </span><a name="local-6989586621679047244"><a href="#local-6989586621679047244"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047243"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047244"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048616"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048616"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-174"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048615"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048615"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-175"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048065"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048065"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-178"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048064"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048064"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-179"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-180"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048063"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048063"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-182"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048061"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048061"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679048062"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-183"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-184"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679048059"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679048059"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679048060"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047940"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.EnsureTypeOp.html#CanEnsureTypeOp"><span class="hs-identifier hs-type">CanEnsureTypeOp</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047940"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679047941"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679047942"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-8214565720323818382"><a href="Control.EnsureTypeOp.html#ensureTypeOp"><span class="hs-identifier">ensureTypeOp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.CollectErrors.html#noErrors"><span class="hs-identifier hs-var">noErrors</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-193"></a><span class="hs-identifier">lift1ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047833"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679047833"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047834"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679047835"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047834"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047833"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047835"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679047833"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047834"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><a name="lift1ensureCE"><a href="Control.CollectErrors.html#lift1ensureCE"><span class="hs-identifier">lift1ensureCE</span></a></a><span> </span><a name="local-6989586621679047929"><a href="#local-6989586621679047929"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-198"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047930"><a href="#local-6989586621679047930"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047931"><a href="#local-6989586621679047931"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-199"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><a href="#local-6989586621679047931"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679047929"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679047930"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span class="hs-identifier">lift1ensureCE</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679047932"><a href="#local-6989586621679047932"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-202"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679047932"><span class="hs-identifier hs-var">ae</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">{-|
  Add error collection support to a binary function whose
  result may already have collected errors.
-}</span><span>
</span><a name="line-208"></a><span class="hs-identifier">lift2ensureCE</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679047829"><span class="hs-identifier hs-type">es</span></a><span class="hs-special">,</span><span> </span><a href="Control.CollectErrors.html#CanEnsureCE"><span class="hs-identifier hs-type">CanEnsureCE</span></a><span> </span><a href="#local-6989586621679047829"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047830"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679047831"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047832"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047830"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047829"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047831"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-type">CollectErrors</span></a><span> </span><a href="#local-6989586621679047829"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047832"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#EnsureCE"><span class="hs-identifier hs-type">EnsureCE</span></a><span> </span><a href="#local-6989586621679047829"><span class="hs-identifier hs-type">es</span></a><span> </span><a href="#local-6989586621679047830"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><a name="lift2ensureCE"><a href="Control.CollectErrors.html#lift2ensureCE"><span class="hs-identifier">lift2ensureCE</span></a></a><span> </span><a name="local-6989586621679047933"><a href="#local-6989586621679047933"><span class="hs-identifier">fn</span></a></a><span>
</span><a name="line-213"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047934"><a href="#local-6989586621679047934"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047935"><a href="#local-6989586621679047935"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679047936"><a href="#local-6989586621679047936"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679047937"><a href="#local-6989586621679047937"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-214"></a><span>        </span><a href="Control.CollectErrors.html#prependErrors"><span class="hs-identifier hs-var">prependErrors</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047935"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679047937"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#ensureCE"><span class="hs-identifier hs-var">ensureCE</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679047933"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679047934"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679047936"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span class="hs-identifier">lift2ensureCE</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679047938"><a href="#local-6989586621679047938"><span class="hs-identifier">ae</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679047939"><a href="#local-6989586621679047939"><span class="hs-identifier">be</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-217"></a><span>        </span><a href="Control.CollectErrors.html#CollectErrors"><span class="hs-identifier hs-var">CollectErrors</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047938"><span class="hs-identifier hs-var">ae</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679047939"><span class="hs-identifier hs-var">be</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- Templates for instances propagating CollectErrors through operations</span><span>
</span><a name="line-220"></a><span class="hs-comment">--</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- makeInstanceForCollectErrors2 :: Name -&gt; Q Type -&gt; [Q Exp] -&gt; Q Dec</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- makeInstanceForCollectErrors2 opClass resultType operations =</span><span>
</span><a name="line-223"></a><span class="hs-comment">--   -- instanceD (return []) (conT opClass `appT` (conT ''CollectErrors `appT` (varT (mkName &quot;es&quot;)))) []</span><span>
</span><a name="line-224"></a><span class="hs-comment">--   [d|</span><span>
</span><a name="line-225"></a><span class="hs-comment">--     instance</span><span>
</span><a name="line-226"></a><span class="hs-comment">--       (Monoid es) =&gt;</span><span>
</span><a name="line-227"></a><span class="hs-comment">--       $(conT opClass `appT` (conT ''CollectErrors `appT` (varT (mkName &quot;es&quot;))))</span><span>
</span><a name="line-228"></a><span class="hs-comment">--       where</span><span>
</span><a name="line-229"></a><span class="hs-comment">--</span><span>
</span><a name="line-230"></a><span class="hs-comment">--   |]</span><span>
</span><a name="line-231"></a><span class="hs-comment">--</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- instance</span><span>
</span><a name="line-233"></a><span class="hs-comment">--   (CanMinMaxAsymmetric a b</span><span>
</span><a name="line-234"></a><span class="hs-comment">--   , CanEnsureCE es (MinMaxType a b)</span><span>
</span><a name="line-235"></a><span class="hs-comment">--   , Monoid es)</span><span>
</span><a name="line-236"></a><span class="hs-comment">--   =&gt;</span><span>
</span><a name="line-237"></a><span class="hs-comment">--   CanMinMaxAsymmetric (CollectErrors es a) (CollectErrors es  b)</span><span>
</span><a name="line-238"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-239"></a><span class="hs-comment">--   type MinMaxType (CollectErrors es a) (CollectErrors es b) =</span><span>
</span><a name="line-240"></a><span class="hs-comment">--     EnsureCE es (MinMaxType a b)</span><span>
</span><a name="line-241"></a><span class="hs-comment">--   min = CN.lift2ensureCE min</span><span>
</span><a name="line-242"></a><span class="hs-comment">--   max = CN.lift2ensureCE max</span><span>
</span><a name="line-243"></a></pre></body></html>