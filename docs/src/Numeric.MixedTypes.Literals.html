<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
    Module      :  Numeric.MixedType.Literals
    Description :  Fixed-type numeric literals, conversions
    Copyright   :  (c) Michal Konecny
    License     :  BSD3

    Maintainer  :  mikkonecny@gmail.com
    Stability   :  experimental
    Portability :  portable

    This module defines fixed-type integer and rational literals.
    This is useful when deriving the type of an expression bottom-up.
    Eg we would not be able to write @1 &lt; x@
    when the type of @&lt;@ does not force the two sides to be of the
    same type.  We would need to write eg @(1::Integer) &lt; x@ with
    Prelude's generic literals.

    Moreover, convenient conversion functions are provided for
    the most common numeric types.  Thus one can say eg:

    * @take (int 1)@
    * @integer (length list)@.
    * @double 0.5@

    To avoid integer overflow, no aritmetic operations return 'Int'.
    Nevertheless, one can usually mix 'Int' with other types in expressions.

    Any approximate arithmetic, ie arithmetic involving Doubles, returns
    values of type 'Double'.
    'Double' values cannot be easily converted to exact
    types such as 'Rational' or 'Integer' so that all such
    conversions are clearly visible as labelled as inexact.
-}</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">MixedTypes</span><span class="hs-operator">.</span><span class="hs-identifier">Literals</span><span>
</span><a name="line-37"></a><span class="hs-special">(</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-comment">-- * Fixed-type literals</span><span>
</span><a name="line-39"></a><span>  </span><a href="Numeric.MixedTypes.Literals.html#fromInteger"><span class="hs-identifier hs-var">fromInteger</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#fromRational"><span class="hs-identifier hs-var">fromRational</span></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-comment">-- * Generalised if-then-else</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#HasIfThenElse"><span class="hs-identifier hs-type">HasIfThenElse</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- * Convenient conversions</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier hs-type">CanBeInteger</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#integer"><span class="hs-identifier hs-var">integer</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#integers"><span class="hs-identifier hs-var">integers</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#HasIntegers"><span class="hs-identifier hs-type">HasIntegers</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#fromInteger_"><span class="hs-identifier hs-var">fromInteger_</span></a><span>
</span><a name="line-44"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#CanBeInt"><span class="hs-identifier hs-type">CanBeInt</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#int"><span class="hs-identifier hs-var">int</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ints"><span class="hs-identifier hs-var">ints</span></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#CanBeRational"><span class="hs-identifier hs-type">CanBeRational</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#rational"><span class="hs-identifier hs-var">rational</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#rationals"><span class="hs-identifier hs-var">rationals</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#HasRationals"><span class="hs-identifier hs-type">HasRationals</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#fromRational_"><span class="hs-identifier hs-var">fromRational_</span></a><span>
</span><a name="line-46"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#CanBeDouble"><span class="hs-identifier hs-type">CanBeDouble</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#double"><span class="hs-identifier hs-var">double</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#doubles"><span class="hs-identifier hs-var">doubles</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactlyTargetSample"><span class="hs-identifier hs-var">convertExactlyTargetSample</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ConvertResult</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ConvertError</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">convError</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-comment">-- * Generic list index</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#specCanBeInteger"><span class="hs-identifier hs-var">specCanBeInteger</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#printArgsIfFails2"><span class="hs-identifier hs-var">printArgsIfFails2</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">-- * Testing support functions</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tInt"><span class="hs-identifier hs-var">tInt</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tInteger"><span class="hs-identifier hs-var">tInteger</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tRational"><span class="hs-identifier hs-var">tRational</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tDouble"><span class="hs-identifier hs-var">tDouble</span></a><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tBool"><span class="hs-identifier hs-var">tBool</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybe"><span class="hs-identifier hs-var">tMaybe</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybeBool"><span class="hs-identifier hs-var">tMaybeBool</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybeMaybeBool"><span class="hs-identifier hs-var">tMaybeMaybeBool</span></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-comment">-- * Helper functions</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertFirst"><span class="hs-identifier hs-var">convertFirst</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertSecond"><span class="hs-identifier hs-var">convertSecond</span></a><span>
</span><a name="line-56"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertFirstUsing"><span class="hs-identifier hs-var">convertFirstUsing</span></a><span class="hs-special">,</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertSecondUsing"><span class="hs-identifier hs-var">convertSecondUsing</span></a><span>
</span><a name="line-57"></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">where</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.TH.DeclForTypes.html"><span class="hs-identifier">Utils</span><span class="hs-operator">.</span><span class="hs-identifier">TH</span><span class="hs-operator">.</span><span class="hs-identifier">DeclForTypes</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Numeric.MixedTypes.PreludeHiding.html"><span class="hs-identifier">Numeric</span><span class="hs-operator">.</span><span class="hs-identifier">MixedTypes</span><span class="hs-operator">.</span><span class="hs-identifier">PreludeHiding</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">P</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Printf</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Convertible</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Convertible</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">convert</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ConvertResult</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ConvertError</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">convError</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">Hspec</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- import Control.Exception (evaluate)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- import Numeric.CollectErrors</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="Control.CollectErrors.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">CollectErrors</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">{-| Replacement for 'Prelude.fromInteger' using the RebindableSyntax extension.
    This version of fromInteger arranges that integer literals
    are always of type 'Integer'.
-}</span><span>
</span><a name="line-81"></a><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-82"></a><a name="fromInteger"><a href="Numeric.MixedTypes.Literals.html#fromInteger"><span class="hs-identifier">fromInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">{-| Replacement for 'Prelude.fromRational' using the RebindableSyntax extension.
    This version of fromRational arranges that rational literals are
    always of type 'Rational'. -}</span><span>
</span><a name="line-87"></a><span class="hs-identifier">fromRational</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-88"></a><a name="fromRational"><a href="Numeric.MixedTypes.Literals.html#fromRational"><span class="hs-identifier">fromRational</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">{-|
  Restore if-then-else with RebindableSyntax
-}</span><span>
</span><a name="line-93"></a><span class="hs-keyword">class</span><span> </span><a name="HasIfThenElse"><a href="Numeric.MixedTypes.Literals.html#HasIfThenElse"><span class="hs-identifier">HasIfThenElse</span></a></a><span> </span><a name="local-6989586621679101232"><a href="#local-6989586621679101232"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679101233"><a href="#local-6989586621679101233"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-identifier">ifThenElse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679101232"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101233"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101233"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101233"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#HasIfThenElse"><span class="hs-identifier hs-type">HasIfThenElse</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><a href="#local-6989586621679101619"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-97"></a><span>  </span><a name="local-8214565720323876103"><a href="Numeric.MixedTypes.Literals.html#ifThenElse"><span class="hs-identifier">ifThenElse</span></a></a><span> </span><a name="local-6989586621679101620"><a href="#local-6989586621679101620"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679101621"><a href="#local-6989586621679101621"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679101622"><a href="#local-6989586621679101622"><span class="hs-identifier">e2</span></a></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679101620"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679101621"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679101622"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">_testIf1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-102"></a><a name="_testIf1"><a href="Numeric.MixedTypes.Literals.html#_testIf1"><span class="hs-identifier">_testIf1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;yes&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;no&quot;</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">{---- Numeric conversions -----}</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">type</span><span> </span><a name="CanBeInteger"><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier">CanBeInteger</span></a></a><span> </span><a name="local-6989586621679101231"><a href="#local-6989586621679101231"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101231"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-107"></a><span class="hs-identifier">integer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier hs-type">CanBeInteger</span></a><span> </span><a href="#local-6989586621679101360"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101360"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-108"></a><a name="integer"><a href="Numeric.MixedTypes.Literals.html#integer"><span class="hs-identifier">integer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-109"></a><span class="hs-identifier">integers</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier hs-type">CanBeInteger</span></a><span> </span><a href="#local-6989586621679101359"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679101359"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><a name="integers"><a href="Numeric.MixedTypes.Literals.html#integers"><span class="hs-identifier">integers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><a name="HasIntegers"><a href="Numeric.MixedTypes.Literals.html#HasIntegers"><span class="hs-identifier">HasIntegers</span></a></a><span> </span><a name="local-6989586621679101230"><a href="#local-6989586621679101230"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><a href="#local-6989586621679101230"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-113"></a><span class="hs-identifier">fromInteger_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#HasIntegers"><span class="hs-identifier hs-type">HasIntegers</span></a><span> </span><a href="#local-6989586621679101358"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101358"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-114"></a><a name="fromInteger_"><a href="Numeric.MixedTypes.Literals.html#fromInteger_"><span class="hs-identifier">fromInteger_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-special">(</span><span class="hs-operator">!!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier hs-type">CanBeInteger</span></a><span> </span><a href="#local-6989586621679101356"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679101357"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101356"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101357"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-117"></a><a name="local-6989586621679101361"><a href="#local-6989586621679101361"><span class="hs-identifier">list</span></a></a><span> </span><a name="%21%21"><a href="Numeric.MixedTypes.Literals.html#%21%21"><span class="hs-operator">!!</span></a></a><span> </span><a name="local-6989586621679101362"><a href="#local-6989586621679101362"><span class="hs-identifier">ix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">genericIndex</span><span> </span><a href="#local-6989586621679101361"><span class="hs-identifier hs-var">list</span></a><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#integer"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="#local-6989586621679101362"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- list !! ix = List.genericIndex list (P.max 0 ((integer ix) P.- 1)) -- deliberately wrong - test the test!</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">{-|
  HSpec properties that each implementation of CanBeInteger should satisfy.
 -}</span><span>
</span><a name="line-123"></a><span class="hs-identifier">specCanBeInteger</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInteger"><span class="hs-identifier hs-type">CanBeInteger</span></a><span> </span><a href="#local-6989586621679101261"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679101261"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679101261"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-125"></a><span>  </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679101261"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Spec</span><span>
</span><a name="line-126"></a><a name="specCanBeInteger"><a href="Numeric.MixedTypes.Literals.html#specCanBeInteger"><span class="hs-identifier">specCanBeInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679101493"><a href="#local-6989586621679101493"><span class="hs-identifier">typeName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679101492"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-identifier hs-var">describe</span><span> </span><span class="hs-string">&quot;generic list index (!!)&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier hs-var">it</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;works using %s index&quot;</span><span> </span><a href="#local-6989586621679101493"><span class="hs-identifier hs-var">typeName</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>      </span><span class="hs-identifier hs-var">property</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679101586"><a href="#local-6989586621679101586"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679101492"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679101587"><a href="#local-6989586621679101587"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#integer"><span class="hs-identifier hs-var">integer</span></a><span> </span><a href="#local-6989586621679101586"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101587"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.&gt;=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679101587"><span class="hs-identifier hs-var">xi</span></a><span class="hs-special">]</span><span> </span><a href="Numeric.MixedTypes.Literals.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span> </span><a href="#local-6989586621679101586"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679101494"><span class="hs-operator hs-var">==$</span></a><span> </span><a href="#local-6989586621679101587"><span class="hs-identifier hs-var">xi</span></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679101494"><a href="#local-6989586621679101494"><span class="hs-operator">==$</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#printArgsIfFails2"><span class="hs-identifier hs-var">printArgsIfFails2</span></a><span> </span><span class="hs-string">&quot;==&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.==</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">printArgsIfFails2</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Testable</span><span> </span><a href="#local-6989586621679101258"><span class="hs-identifier hs-type">prop</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679101259"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679101260"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101259"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101260"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101258"><span class="hs-identifier hs-type">prop</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101259"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101260"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Property</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><a name="printArgsIfFails2"><a href="Numeric.MixedTypes.Literals.html#printArgsIfFails2"><span class="hs-identifier">printArgsIfFails2</span></a></a><span> </span><a name="local-6989586621679101588"><a href="#local-6989586621679101588"><span class="hs-identifier">relName</span></a></a><span> </span><a name="local-6989586621679101589"><a href="#local-6989586621679101589"><span class="hs-identifier">rel</span></a></a><span> </span><a name="local-6989586621679101590"><a href="#local-6989586621679101590"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679101591"><a href="#local-6989586621679101591"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-identifier hs-var">counterexample</span><span> </span><a href="#local-6989586621679101592"><span class="hs-identifier hs-var">argsReport</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679101590"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679101589"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679101591"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>  </span><a name="local-6989586621679101592"><a href="#local-6989586621679101592"><span class="hs-identifier">argsReport</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-string">&quot;FAILED REL: (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679101590"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;) &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679101588"><span class="hs-identifier hs-var">relName</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679101591"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span class="hs-keyword">type</span><span> </span><a name="CanBeInt"><a href="Numeric.MixedTypes.Literals.html#CanBeInt"><span class="hs-identifier">CanBeInt</span></a></a><span> </span><a name="local-6989586621679101229"><a href="#local-6989586621679101229"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101229"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-143"></a><span class="hs-identifier">int</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInt"><span class="hs-identifier hs-type">CanBeInt</span></a><span> </span><a href="#local-6989586621679101257"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101257"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-144"></a><a name="int"><a href="Numeric.MixedTypes.Literals.html#int"><span class="hs-identifier">int</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-145"></a><span class="hs-identifier">ints</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeInt"><span class="hs-identifier hs-type">CanBeInt</span></a><span> </span><a href="#local-6989586621679101256"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679101256"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><a name="ints"><a href="Numeric.MixedTypes.Literals.html#ints"><span class="hs-identifier">ints</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">type</span><span> </span><a name="CanBeRational"><a href="Numeric.MixedTypes.Literals.html#CanBeRational"><span class="hs-identifier">CanBeRational</span></a></a><span> </span><a name="local-6989586621679101228"><a href="#local-6989586621679101228"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101228"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-149"></a><span class="hs-identifier">rational</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeRational"><span class="hs-identifier hs-type">CanBeRational</span></a><span> </span><a href="#local-6989586621679101255"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101255"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-150"></a><a name="rational"><a href="Numeric.MixedTypes.Literals.html#rational"><span class="hs-identifier">rational</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-151"></a><span class="hs-identifier">rationals</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeRational"><span class="hs-identifier hs-type">CanBeRational</span></a><span> </span><a href="#local-6989586621679101254"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679101254"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span>
</span><a name="line-152"></a><a name="rationals"><a href="Numeric.MixedTypes.Literals.html#rationals"><span class="hs-identifier">rationals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-keyword">type</span><span> </span><a name="HasRationals"><a href="Numeric.MixedTypes.Literals.html#HasRationals"><span class="hs-identifier">HasRationals</span></a></a><span> </span><a name="local-6989586621679101227"><a href="#local-6989586621679101227"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><a href="#local-6989586621679101227"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-155"></a><span class="hs-identifier">fromRational_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#HasRationals"><span class="hs-identifier hs-type">HasRationals</span></a><span> </span><a href="#local-6989586621679101253"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101253"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-156"></a><a name="fromRational_"><a href="Numeric.MixedTypes.Literals.html#fromRational_"><span class="hs-identifier">fromRational_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-keyword">type</span><span> </span><a name="CanBeDouble"><a href="Numeric.MixedTypes.Literals.html#CanBeDouble"><span class="hs-identifier">CanBeDouble</span></a></a><span> </span><a name="local-6989586621679101226"><a href="#local-6989586621679101226"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Convertible</span><span> </span><a href="#local-6989586621679101226"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-159"></a><span class="hs-identifier">double</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeDouble"><span class="hs-identifier hs-type">CanBeDouble</span></a><span> </span><a href="#local-6989586621679101252"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101252"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-160"></a><a name="double"><a href="Numeric.MixedTypes.Literals.html#double"><span class="hs-identifier">double</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">convert</span><span>
</span><a name="line-161"></a><span class="hs-identifier">doubles</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#CanBeDouble"><span class="hs-identifier hs-type">CanBeDouble</span></a><span> </span><a href="#local-6989586621679101251"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679101251"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">]</span><span>
</span><a name="line-162"></a><a name="doubles"><a href="Numeric.MixedTypes.Literals.html#doubles"><span class="hs-identifier">doubles</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">convert</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">{-|
Define our own ConvertibleExactly since convertible is too relaxed for us.
For example, convertible allows conversion from Rational to Integer,
rounding to nearest integer.  We prefer to allow only exact conversions.
-}</span><span>
</span><a name="line-169"></a><span class="hs-keyword">class</span><span> </span><a name="ConvertibleExactly"><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier">ConvertibleExactly</span></a></a><span> </span><a name="local-6989586621679101224"><a href="#local-6989586621679101224"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679101225"><a href="#local-6989586621679101225"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-identifier">safeConvertExactly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679101224"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConvertResult</span><span> </span><a href="#local-6989586621679101225"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-keyword">default</span><span> </span><span class="hs-identifier">safeConvertExactly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Convertible</span><span> </span><a href="#local-6989586621679101224"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679101225"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101224"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ConvertResult</span><span> </span><a href="#local-6989586621679101225"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-172"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">safeConvert</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-identifier">convertExactly</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101249"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679101250"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101249"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101250"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-175"></a><a name="convertExactly"><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier">convertExactly</span></a></a><span> </span><a name="local-6989586621679101593"><a href="#local-6989586621679101593"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier hs-var">safeConvertExactly</span></a><span> </span><a href="#local-6989586621679101593"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679101594"><a href="#local-6989586621679101594"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101594"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679101595"><a href="#local-6989586621679101595"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679101595"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-identifier">convertExactlyTargetSample</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101247"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-6989586621679101248"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679101248"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101247"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101248"><span class="hs-identifier hs-type">t2</span></a><span>
</span><a name="line-181"></a><a name="convertExactlyTargetSample"><a href="Numeric.MixedTypes.Literals.html#convertExactlyTargetSample"><span class="hs-identifier">convertExactlyTargetSample</span></a></a><span> </span><a name="local-6989586621679101596"><a href="#local-6989586621679101596"><span class="hs-identifier">_sample</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-comment">-- use CVT instance by default</span><span>
</span><a name="line-184"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><a name="local-6989586621679101618"><a href="#local-6989586621679101618"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679101618"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-188"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><a name="local-6989586621679101617"><a href="#local-6989586621679101617"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679101617"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-192"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-193"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><a name="local-6989586621679101613"><a href="#local-6989586621679101613"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-keyword">do</span><span>
</span><a name="line-198"></a><span>    </span><a name="local-6989586621679101614"><a href="#local-6989586621679101614"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">safeConvert</span><span> </span><a href="#local-6989586621679101613"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">properFraction</span><span> </span><a href="#local-6989586621679101614"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-200"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679101615"><a href="#local-6989586621679101615"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101616"><a href="#local-6989586621679101616"><span class="hs-identifier">fr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679101615"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.==</span><span> </span><a href="#local-6989586621679101613"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.&amp;&amp;</span><span> </span><a href="#local-6989586621679101616"><span class="hs-identifier hs-var">fr</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.==</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#double"><span class="hs-identifier hs-var">double</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679101614"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-201"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">convError</span><span> </span><span class="hs-string">&quot;Integer could not be exactly converted to Double&quot;</span><span> </span><a href="#local-6989586621679101613"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><a name="local-6989586621679101609"><a href="#local-6989586621679101609"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-keyword">do</span><span>
</span><a name="line-206"></a><span>    </span><a name="local-6989586621679101610"><a href="#local-6989586621679101610"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">safeConvert</span><span> </span><a href="#local-6989586621679101609"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-207"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">properFraction</span><span> </span><a href="#local-6989586621679101610"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-208"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679101611"><a href="#local-6989586621679101611"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679101612"><a href="#local-6989586621679101612"><span class="hs-identifier">fr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679101611"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.==</span><span> </span><a href="#local-6989586621679101609"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.&amp;&amp;</span><span> </span><a href="#local-6989586621679101612"><span class="hs-identifier hs-var">fr</span></a><span> </span><span class="hs-identifier hs-var">P</span><span class="hs-operator hs-var">.==</span><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#double"><span class="hs-identifier hs-var">double</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679101610"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-209"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">convError</span><span> </span><span class="hs-string">&quot;Int could not be exactly converted to Double&quot;</span><span> </span><a href="#local-6989586621679101609"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-keyword">instance</span><span> </span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-212"></a><span>  </span><a name="local-8214565720323876095"><a href="Numeric.MixedTypes.Literals.html#safeConvertExactly"><span class="hs-identifier">safeConvertExactly</span></a></a><span> </span><a name="local-6989586621679101608"><a href="#local-6989586621679101608"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679101608"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">{-- we deliberately do not allow converions from Double to any other type --}</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">{-- auxiliary type and functions for specifying type(s) to use in tests  --}</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">{-|
  A runtime representative of type @t@.
  Used for specialising polymorphic tests to concrete types.
-}</span><span>
</span><a name="line-222"></a><span class="hs-keyword">data</span><span> </span><a name="T"><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier">T</span></a></a><span> </span><a name="local-6989586621679101223"><a href="#local-6989586621679101223"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="T"><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier">T</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-identifier">tInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-225"></a><a name="tInt"><a href="Numeric.MixedTypes.Literals.html#tInt"><span class="hs-identifier">tInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-identifier">tInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-228"></a><a name="tInteger"><a href="Numeric.MixedTypes.Literals.html#tInteger"><span class="hs-identifier">tInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-string">&quot;Integer&quot;</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-identifier">tRational</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-231"></a><a name="tRational"><a href="Numeric.MixedTypes.Literals.html#tRational"><span class="hs-identifier">tRational</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-string">&quot;Rational&quot;</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-identifier">tDouble</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-234"></a><a name="tDouble"><a href="Numeric.MixedTypes.Literals.html#tDouble"><span class="hs-identifier">tDouble</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-string">&quot;Double&quot;</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-identifier">tBool</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-237"></a><a name="tBool"><a href="Numeric.MixedTypes.Literals.html#tBool"><span class="hs-identifier">tBool</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-string">&quot;Bool&quot;</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-identifier">tMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679101246"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679101246"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><a name="tMaybe"><a href="Numeric.MixedTypes.Literals.html#tMaybe"><span class="hs-identifier">tMaybe</span></a></a><span> </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679101597"><a href="#local-6989586621679101597"><span class="hs-identifier">tName</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;(Maybe &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679101597"><span class="hs-identifier hs-var">tName</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-identifier">tMaybeBool</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><a name="tMaybeBool"><a href="Numeric.MixedTypes.Literals.html#tMaybeBool"><span class="hs-identifier">tMaybeBool</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybe"><span class="hs-identifier hs-var">tMaybe</span></a><span> </span><a href="Numeric.MixedTypes.Literals.html#tBool"><span class="hs-identifier hs-var">tBool</span></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-identifier">tMaybeMaybeBool</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Numeric.MixedTypes.Literals.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><a name="tMaybeMaybeBool"><a href="Numeric.MixedTypes.Literals.html#tMaybeMaybeBool"><span class="hs-identifier">tMaybeMaybeBool</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybe"><span class="hs-identifier hs-var">tMaybe</span></a><span> </span><a href="Numeric.MixedTypes.Literals.html#tMaybeBool"><span class="hs-identifier hs-var">tMaybeBool</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">{---- Auxiliary functions ----}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-identifier">convertFirstUsing</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-251"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101244"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ conversion function -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101245"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ same-type operation -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101245"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ mixed-type operation -}</span><span>
</span><a name="line-254"></a><a name="convertFirstUsing"><a href="Numeric.MixedTypes.Literals.html#convertFirstUsing"><span class="hs-identifier">convertFirstUsing</span></a></a><span> </span><a name="local-6989586621679101598"><a href="#local-6989586621679101598"><span class="hs-identifier">conv</span></a></a><span> </span><a name="local-6989586621679101599"><a href="#local-6989586621679101599"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679101600"><a href="#local-6989586621679101600"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679101601"><a href="#local-6989586621679101601"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679101599"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101598"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="#local-6989586621679101600"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679101601"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679101601"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-identifier">convertSecondUsing</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101240"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101241"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101240"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ conversion function -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101240"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101240"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101242"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ same-type operation -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-259"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101240"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101241"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101242"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ mixed-type operation -}</span><span>
</span><a name="line-260"></a><a name="convertSecondUsing"><a href="Numeric.MixedTypes.Literals.html#convertSecondUsing"><span class="hs-identifier">convertSecondUsing</span></a></a><span> </span><a name="local-6989586621679101602"><a href="#local-6989586621679101602"><span class="hs-identifier">conv</span></a></a><span> </span><a name="local-6989586621679101603"><a href="#local-6989586621679101603"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679101604"><a href="#local-6989586621679101604"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679101605"><a href="#local-6989586621679101605"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679101603"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679101604"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679101602"><span class="hs-identifier hs-var">conv</span></a><span> </span><a href="#local-6989586621679101604"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679101605"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-identifier">convertFirst</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101237"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679101238"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-264"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101238"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101238"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101239"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ same-type operation -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101237"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101238"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101239"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ mixed-type operation -}</span><span>
</span><a name="line-266"></a><a name="convertFirst"><a href="Numeric.MixedTypes.Literals.html#convertFirst"><span class="hs-identifier">convertFirst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertFirstUsing"><span class="hs-identifier hs-var">convertFirstUsing</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679101606"><a href="#local-6989586621679101606"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span> </span><a href="#local-6989586621679101606"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-identifier">convertSecond</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-special">(</span><a href="Numeric.MixedTypes.Literals.html#ConvertibleExactly"><span class="hs-identifier hs-type">ConvertibleExactly</span></a><span> </span><a href="#local-6989586621679101234"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679101235"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101235"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101235"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101236"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ same-type operation -}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679101235"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101234"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679101236"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">{-^ mixed-type operation -}</span><span>
</span><a name="line-272"></a><a name="convertSecond"><a href="Numeric.MixedTypes.Literals.html#convertSecond"><span class="hs-identifier">convertSecond</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertSecondUsing"><span class="hs-identifier hs-var">convertSecondUsing</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679101607"><a href="#local-6989586621679101607"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Numeric.MixedTypes.Literals.html#convertExactly"><span class="hs-identifier hs-var">convertExactly</span></a><span> </span><a href="#local-6989586621679101607"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- instance</span><span>
</span><a name="line-275"></a><span class="hs-comment">--   (ConvertibleExactly t1 t2, SuitableForCE es)</span><span>
</span><a name="line-276"></a><span class="hs-comment">--   =&gt;</span><span>
</span><a name="line-277"></a><span class="hs-comment">--   ConvertibleExactly t1 (CollectErrors es t2)</span><span>
</span><a name="line-278"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-279"></a><span class="hs-comment">--   safeConvertExactly = fmap pure . safeConvertExactly</span><span>
</span><a name="line-280"></a><span class="hs-comment">--</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-operator">$</span><span class="hs-special">(</span><span class="hs-identifier hs-var">declForTypes</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-var">t</span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Bool</span><span> </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">t</span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Integer</span><span> </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">t</span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Int</span><span> </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">t</span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Rational</span><span> </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">t</span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Double</span><span> </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier hs-var">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">d</span><span class="hs-glyph">|</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span>    </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ConvertibleExactly</span><span> </span><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">t</span><span> </span><span class="hs-identifier hs-var">t</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Monoid</span><span> </span><span class="hs-identifier hs-var">es</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-var">ConvertibleExactly</span><span> </span><span class="hs-operator hs-var">$</span><span class="hs-identifier hs-var">t</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CollectErrors</span><span> </span><span class="hs-identifier hs-var">es</span><span> </span><span class="hs-identifier hs-var">t</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-287"></a><span>      </span><span class="hs-identifier hs-var">safeConvertExactly</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier hs-var">v</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">CollectErrors</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">v</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">safeConvertExactly</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-glyph">|</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a></pre></body></html>